<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Employee Lifecycle AI{% endblock %}</title>
    <link rel="stylesheet" href="/static/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>
    <div class="container {% block container_class %}{% endblock %}">

        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">
                <h2>ðŸ§¬ Lifecycle AI</h2>
            </div>
            <div class="menu">
                <a href="/" class="menu-link">
                    <div class="menu-item {% if request.path == '/' %}active{% endif %}">
                        <i class="fas fa-comment-dots"></i> Chat Agent
                    </div>
                </a>
                <a href="/audit-logs" class="menu-link">
                    <div class="menu-item {% if request.path == '/audit-logs' %}active{% endif %}">
                        <i class="fas fa-history"></i> Audit Logs
                    </div>
                </a>
                <a href="/integrations" class="menu-link">
                    <div class="menu-item {% if request.path == '/integrations' %}active{% endif %}">
                        <i class="fas fa-plug"></i> Integrations
                    </div>
                </a>
            </div>

            <!-- User Auth Section -->
            <div class="user-section">
                <div id="user-profile" style="display: none;">
                    <div class="user-info">
                        <div class="user-avatar">A</div>
                        <span id="username">Admin</span>
                    </div>
                    <button class="btn-logout" id="logout-btn">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
                <div id="login-section">
                    <button class="btn-login" id="login-btn">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>
                </div>
            </div>

            <div class="status">
                <div class="status-indicator online"></div>
                <span>System Online</span>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="main-content">
            {% block content %}{% endblock %}
        </div>
    </div>
    {% block scripts %}{% endblock %}
    <script>
        async function updateAuthState() {
            const resp = await fetch('/api/auth/status');
            const state = await resp.json();
            const profile = document.getElementById('user-profile');
            const loginSection = document.getElementById('login-section');
            const username = document.getElementById('username');

            if (state.logged_in) {
                profile.style.display = 'flex';
                loginSection.style.display = 'none';
                username.innerText = state.user;
            } else {
                profile.style.display = 'none';
                loginSection.style.display = 'block';
            }
        }

        document.getElementById('login-btn')?.addEventListener('click', async () => {
            const resp = await fetch('/api/auth/login', { method: 'POST' });
            if (resp.ok) updateAuthState();
        });

        document.getElementById('logout-btn')?.addEventListener('click', async () => {
            const resp = await fetch('/api/auth/logout', { method: 'POST' });
            if (resp.ok) updateAuthState();
        });

        // Initial check
        updateAuthState();
    </script>
</body>

</html>